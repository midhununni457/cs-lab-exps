-- exceptions.sql
-- Examples: BEGIN, EXCEPTION, END, NO_DATA_FOUND, TOO_MANY_ROWS, RAISE, RAISE_APPLICATION_ERROR, DECLARE

-- NO_DATA_FOUND example
DECLARE
  v_name students.first_name%TYPE;
BEGIN
  SELECT first_name INTO v_name FROM students WHERE student_id = -1; -- likely no row
  DBMS_OUTPUT.PUT_LINE('Name: ' || v_name);
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE('No student found');
END;
/
-- TOO_MANY_ROWS example
DECLARE
  v_name students.first_name%TYPE;
BEGIN
  SELECT first_name INTO v_name FROM students WHERE last_name = 'Smith'; -- may return >1 row
  DBMS_OUTPUT.PUT_LINE('Name: ' || v_name);
EXCEPTION
  WHEN TOO_MANY_ROWS THEN
    DBMS_OUTPUT.PUT_LINE('More than one row returned');
END;
/
-- RAISE example
DECLARE
  v_num NUMBER := -1;
BEGIN
  IF v_num < 0 THEN
    RAISE_APPLICATION_ERROR(-20001, 'Negative numbers are not allowed');
  END IF;
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
END;
/
-- DECLARE block example with user-defined exception
DECLARE
  ex_custom EXCEPTION;
BEGIN
  RAISE ex_custom;
EXCEPTION
  WHEN ex_custom THEN
    DBMS_OUTPUT.PUT_LINE('Custom exception raised');
END;
/
